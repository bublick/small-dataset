{{ define "main" }}
<article>
    <div class="container mt-3">
        <nav class="breadcrumb">
            <ol itemscope itemtype="https://schema.org/BreadcrumbList">
                <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                    <a class="main-link" itemprop="item" href="/"><span itemprop="name">Home</span></a>
                    <meta itemprop="position" content="1">
                </li>
                <li class="breadcrumb-arrow">â€º</li>
                <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                    <p class="text-block"><span itemprop="name">{{.Title}}</span></p>
                    <meta itemprop="position" content="2">
                </li>
            </ol>
        </nav>

        <h1 class="base-headline">Our shop partners</h1>
    </div>

    <div class="container mb-5 mt-5">
        <p class="text-block">Our shop partners are directly integrated into the platform and provide daily updated availabilities and prices. This way, you can interactively search for the best
            offers in the app. The most convenient way to find exciting offers is our "Buyer's Guide" in the <a class="main-link" href="page.refs_dynamicLink"clear>free RumX app</a>.</p>
        <a class="intro-button-download-app-store" href="{{ .Site.Params.rumx.app_store_url }}"><img class="dl-image" src="/assets/images/download-app-store.webp" alt="Download app on app store"></a>
        <a class="intro-button-download-google-play" href="{{ .Site.Params.rumx.google_play_url }}"><img class="dl-image" src="/assets/images/download-google-play.webp" alt="Download app on google play"></a>

        <div class="row">
            {{$sortedShops := dict}}
            {{with .Site.Data.sortedShops}}
                {{range $index, $shop := .}}
                    {{$shopName := .shopName}}
                    {{$shopUrl := .shopUrl}}
                    {{$shopLogo := .shopLogo}}

                    {{ $singleShop := dict "name" .shopName "url" .shopUrl "logo" .shopLogo }}
                    {{ $sortedShops = merge $sortedShops (dict (string $index) $singleShop) }}
                {{end}}
            {{end}}
            {{$sortedShops := sort $sortedShops "name" "asc"}}

            {{with .Site.Data.sortedShops}}
                {{range $index, $shop := .}}
                    {{$rumsAmount := 0}}
                    {{$shopName := .shopName}}
                    {{$shopUrl := .shopUrl}}
                    {{$shopLogo := .shopLogo}}

                    {{/* Next for each shop open list of rums.md and calculate amount */}}
                    {{ range where $.Site.Data.shop_items_by_rx "shop" $shopName }}
                        {{$rumsAmount = add $rumsAmount 1}}
                    {{end}}
                    {{if gt $rumsAmount 0}}
                        {{ partial "shop_item.html" (dict "shopName" $shopName "shopUrl" $shopUrl "shopLogo" $shopLogo "rumsAmount" $rumsAmount) }}
                    {{end}}
                    {{/* End of calculation */}}
                {{end}}
            {{end}}
        </div>

        <p class="mt-3 mb-5"><a class="main-link" href="mailto:{{ .Site.Params.email }}">Do you run an online store and want to be listed? Contact us!</a></p>
    </div>
</article>
{{ end }}